# Search Service Environment Variables

# Database
SEARCH_DATABASE_URL="postgresql://username:password@localhost:5432/ultramarket_search"

# Service Configuration
PORT=3011
NODE_ENV="development"
SERVICE_NAME="search-service"

# Redis (for caching search results)
REDIS_URL="redis://localhost:6379"
REDIS_PASSWORD=""
SEARCH_CACHE_TTL=3600 # 1 hour

# Elasticsearch Configuration
ELASTICSEARCH_URL="http://localhost:9200"
ELASTICSEARCH_INDEX_PREFIX="ultramarket"
ELASTICSEARCH_USERNAME=""
ELASTICSEARCH_PASSWORD=""
ELASTICSEARCH_SSL=false

# External Services
AUTH_SERVICE_URL="http://localhost:3001"
TECH_PRODUCT_SERVICE_URL="http://localhost:3004"
STORE_SERVICE_URL="http://localhost:3003"
ANALYTICS_SERVICE_URL="http://localhost:3009"

# Search Configuration
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100
MAX_SEARCH_QUERY_LENGTH=200
SEARCH_TIMEOUT_MS=5000

# Indexing Configuration
ENABLE_AUTO_INDEXING=true
INDEX_BATCH_SIZE=1000
INDEX_UPDATE_INTERVAL_MINUTES=15
FULL_REINDEX_HOUR=2 # 2 AM daily

# Search Features
ENABLE_AUTOCOMPLETE=true
ENABLE_SPELL_CHECK=true
ENABLE_SYNONYMS=true
ENABLE_PERSONALIZATION=true
ENABLE_FACETED_SEARCH=true

# Autocomplete Configuration
AUTOCOMPLETE_MIN_QUERY_LENGTH=2
AUTOCOMPLETE_MAX_SUGGESTIONS=10
AUTOCOMPLETE_CACHE_TTL=1800 # 30 minutes

# Spell Check
SPELL_CHECK_THRESHOLD=0.8
SPELL_CHECK_MAX_SUGGESTIONS=5
ENABLE_FUZZY_SEARCH=true
FUZZY_SEARCH_DISTANCE=2

# Personalization
PERSONALIZATION_WEIGHT=0.3
MIN_USER_SEARCHES_FOR_PERSONALIZATION=10
PERSONALIZATION_UPDATE_INTERVAL_HOURS=24

# Analytics & Tracking
ENABLE_SEARCH_ANALYTICS=true
ANALYTICS_BATCH_SIZE=500
ANALYTICS_FLUSH_INTERVAL_MS=30000
TRACK_USER_CLICKS=true
TRACK_SEARCH_SESSIONS=true

# Search Ranking
POPULARITY_WEIGHT=0.4
RELEVANCE_WEIGHT=0.4
FRESHNESS_WEIGHT=0.1
QUALITY_WEIGHT=0.1

# Filters Configuration
ENABLE_PRICE_FILTER=true
ENABLE_BRAND_FILTER=true
ENABLE_CATEGORY_FILTER=true
ENABLE_RATING_FILTER=true
ENABLE_AVAILABILITY_FILTER=true
ENABLE_LOCATION_FILTER=true

# Performance
SEARCH_RESULT_CACHE_TTL=300 # 5 minutes
FACET_CACHE_TTL=1800 # 30 minutes
SUGGESTION_CACHE_TTL=3600 # 1 hour
MAX_CONCURRENT_SEARCHES=100

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000 # 1 minute
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=true

# Search Quality
MIN_SEARCH_RESULTS_FOR_QUALITY=5
QUALITY_SCORE_THRESHOLD=0.7
ENABLE_RESULT_DIVERSIFICATION=true
MAX_RESULTS_PER_STORE=5

# Trending & Popularity
TRENDING_UPDATE_INTERVAL_MINUTES=30
TRENDING_LOOKBACK_HOURS=24
POPULARITY_DECAY_FACTOR=0.95
MIN_SEARCHES_FOR_TRENDING=50

# Language & Localization
DEFAULT_LANGUAGE="uz"
SUPPORTED_LANGUAGES="uz,ru,en"
ENABLE_MULTI_LANGUAGE_SEARCH=true
LANGUAGE_DETECTION=true

# Security
ENABLE_SEARCH_SANITIZATION=true
MAX_SEARCH_TERMS=20
BLOCKED_SEARCH_TERMS=""
ENABLE_SEARCH_ABUSE_DETECTION=true

# Monitoring & Logging
LOG_LEVEL="info"
LOG_FILE="logs/search-service.log"
ENABLE_SEARCH_QUERY_LOGGING=true
ENABLE_PERFORMANCE_LOGGING=true

# Machine Learning
ENABLE_ML_RANKING=false
ML_MODEL_UPDATE_INTERVAL_HOURS=24
ML_RANKING_WEIGHT=0.2
ML_MODEL_PATH="models/search_ranking.pkl"

# Search Suggestions
SUGGESTION_UPDATE_INTERVAL_HOURS=6
MIN_QUERY_COUNT_FOR_SUGGESTION=10
MAX_SUGGESTIONS_PER_QUERY=20
ENABLE_TRENDING_SUGGESTIONS=true

# Export & Import
ENABLE_SEARCH_DATA_EXPORT=true
EXPORT_FORMATS="json,csv"
MAX_EXPORT_RECORDS=100000

# CORS
CORS_ORIGIN="http://localhost:3000,http://localhost:3001"

# Health Check
HEALTH_CHECK_INTERVAL_MS=30000
ELASTICSEARCH_HEALTH_CHECK=true
REDIS_HEALTH_CHECK=true